const CACHE_NAME = "solorpg-cache-v1";
const urlsToCache = [
    "/",
    "css/style.css",
    "img/android-chrome-192x192.png",
    "img/android-chrome-512x512.png",
    "img/anel.png",
    "img/armadilha.png",
    "img/b1.jpg",
    "img/b2.jpg",
    "img/b3.jpg",
    "img/b4.jpg",
    "img/b5.jpg",
    "img/b6.jpg",
    "img/bau.png",
    "img/bg_a_seita.png",
    "img/bg_aventuras.webp",
    "img/bg_bestiario.webp",
    "img/bg_castelo.webp",
    "img/bg_cidadepoco.webp",
    "img/bg_dominus_dragons.webp",
    "img/bg_drak.webp",
    "img/bg_fagulhas_deck.png",
    "img/bg_fantasia.webp",
    "img/bg_fatesolo.webp",
    "img/bg_festa.webp",
    "img/bg_flextrair.webp",
    "img/bg_ger_altaris.png",
    "img/bg_ger_c4.webp",
    "img/bg_ger_criaturas.webp",
    "img/bg_ger_ftq.png",
    "img/bg_ger_ihunt.webp",
    "img/bg_ger_intrepidos.webp",
    "img/bg_ger_mundosfate.webp",
    "img/bg_ger_notequest.webp",
    "img/bg_ger_pdn.webp",
    "img/bg_ger_ronin.webp",
    "img/bg_ger_solo10.webp",
    "img/bg_ger_tinydungeon.webp",
    "img/bg_ger_umdaar.webp",
    "img/bg_ger_uvg.png",
    "img/bg_hexcards.png",
    "img/bg_irregulares.webp",
    "img/bg_metal.webp",
    "img/bg_opis.webp",
    "img/bg_orac_cidades.webp",
    "img/bg_orac_fagulhas.webp",
    "img/bg_orac_grandesoraculos.webp",
    "img/bg_orac_opisdeck.webp",
    "img/bg_out_25hora.webp",
    "img/bg_out_agon.webp",
    "img/bg_out_discord.webp",
    "img/bg_out_fatedice.webp",
    "img/bg_out_pixador.webp",
    "img/bg_out_race.webp",
    "img/bg_pescaria.png",
    "img/bg_phantasy.webp",
    "img/bg_pindorama.webp",
    "img/bg_pokemon.webp",
    "img/bg_robos.webp",
    "img/bg_runas.webp",
    "img/bg_serie.webp",
    "img/bg_torre.webp",
    "img/bg_xamanismo.webp",
    "img/bota.png",
    "img/buraco.png",
    "img/cetro.png",
    "img/cla1.jpg",
    "img/cla2.jpg",
    "img/cla3.jpg",
    "img/cla4.jpg",
    "img/cla5.jpg",
    "img/cla6.jpg",
    "img/cla7.jpg",
    "img/cla8.jpg",
    "img/cla9.jpg",
    "img/cla10.jpg",
    "img/cla11.jpg",
    "img/cla12.jpg",
    "img/cla13.jpg",
    "img/cla14.jpg",
    "img/cla15.jpg",
    "img/cla16.jpg",
    "img/cla17.jpg",
    "img/cla18.jpg",
    "img/cla19.jpg",
    "img/cla20.jpg",
    "img/cla21.jpg",
    "img/cla22.jpg",
    "img/cla23.jpg",
    "img/cla24.jpg",
    "img/cla25.jpg",
    "img/cla26.jpg",
    "img/cla27.jpg",
    "img/cla28.jpg",
    "img/cla29.jpg",
    "img/cla30.jpg",
    "img/cla31.jpg",
    "img/cla32.jpg",
    "img/cla33.jpg",
    "img/cla34.jpg",
    "img/cla35.jpg",
    "img/cla36.jpg",
    "img/clerigo.png",
    "img/codex_dominus.png",
    "img/d6_1.jpg",
    "img/d6_2.jpg",
    "img/d6_3.jpg",
    "img/d6_4.jpg",
    "img/d6_5.jpg",
    "img/d6_6.jpg",
    "img/d10_1.jpg",
    "img/d10_2.jpg",
    "img/d10_3.jpg",
    "img/d10_4.jpg",
    "img/d10_5.jpg",
    "img/d10_6.jpg",
    "img/d10_7.jpg",
    "img/d10_8.jpg",
    "img/d10_9.jpg",
    "img/d10_10.jpg",
    "img/dwarf-face.png",
    "img/escada_entrada.png",
    "img/escada_saida.png",
    "img/espada.png",
    "img/esqueleto.png",
    "img/fantasma.png",
    "img/fate_blank.png",
    "img/fate_minus.png",
    "img/fate_plus.png",
    "img/favicon.ico",
    "img/fudge-dice.png",
    "img/grande_mae.png",
    "img/guerreiro.png",
    "img/hakaba.png",
    "img/horror_pindorama.png",
    "img/ico_bibliotecarpgsolo.webp",
    "img/infaernum.png",
    "img/ladrao.png",
    "img/lattes-new.svg",
    "img/mago.png",
    "img/mais_estranho_rpg.png",
    "img/mountains.jpg",
    "img/mumia.png",
    "img/nomades.png",
    "img/paladino.png",
    "img/pocao.png",
    "img/pokemon-logo.webp",
    "img/poweredbyfate-logo-footer.png",
    "img/ragnaerok.png",
    "img/sengoku.png",
    "img/unas.png",
    "img/velhas_historias_terramedia.png",
    "img/vilao_clerigo.png",
    "img/vilao_guerreiro.png",
    "img/vilao_ladrao.png",
    "img/vilao_mago.png",
    "img/vilao_neutro.png",
    "img/vilao_paladino.png",
    "img/w1.jpg",
    "img/w2.jpg",
    "img/w3.jpg",
    "img/w4.jpg",
    "img/w5.jpg",
    "img/w6.jpg",
    "img/zumbi.png",
    "js/altaris.js",
    "js/aspects.js",
    "js/c4.js",
    "js/classes.js",
    "js/creatures.js",
    "js/dados-fate.js",
    "js/fagulhas.js",
    "js/ftq.js",
    "js/functions.js",
    "js/howler.min.js",
    "js/ihunt.js",
    "js/infaernum.js",
    "js/intrepidos.js",
    "js/legado.js",
    "js/names.js",
    "js/nomades.js",
    "js/notequest.js",
    "js/opis.js",
    "js/pokemon_jornada.js",
    "js/pokemon.js",
    "js/races.js",
    "js/ronin.js",
    "js/runas.js",
    "js/script.js",
    "js/skills.js",
    "js/solo10.js",
    "js/stunts.js",
    "js/tinydungeon.js",
    "js/torre-mortos.js",
    "js/umdaar.js",
    "js/uvg.js",
    "c4.html",
    "dados_fate.html",
    "discord_bot.html",
    "fagulhas.html",
    "gerador_altaris.html",
    "gerador_creatures.html",
    "gerador_fate.html",
    "gerador_ftq.html",
    "gerador_ihunt.html",
    "gerador_npc.html",
    "gerador_solo10_tropas.html",
    "gerador_solo10.html",
    "gerador_tinydungeon.html",
    "gerador_umdaar.html",
    "gerador_uvg.html",
    "gerador_woa.html",
    "geradores.html",
    "index.html",
    "infaernum.html",
    "intrepidos.html",
    "jogo_drak-mauter.html",
    "jogo_fantasia-medieval.html",
    "jogo_pindorama.html",
    "jogo_pokemon-jornada.html",
    "jogo_runas-odin.html",
    "jogo_torre-mortos-vivos.html",
    "legado.html",
    "manifest.json",
    "nav.html",
    "nomades.html",
    "notequest.html",
    "opis.html",
    "oraculos.html",
    "outros.html",
    "pokemon_jornada.html",
    "pokemon.html",
    "robots.txt",
    "ronin.html",
    "rpg_solo.html",
    "runas.html",
    "sitemap.xml",
    "sw.js"
  ];
  
// Instalando o Service Worker e armazenando arquivos no cache
self.addEventListener("install", (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME).then((cache) => {
      console.log("Armazenando arquivos no cache...");
      return cache.addAll(urlsToCache).then(() => self.skipWaiting());
    }).catch((err) => console.error("Erro ao adicionar arquivos ao cache:", err))
  );
});

// Interceptando requisições e servindo do cache
self.addEventListener("fetch", (event) => {
  event.respondWith(
    caches.match(event.request).then((response) => {
      return response || fetch(event.request).catch(() => {
        return caches.match("/geradores.html"); // Página fallback para quando estiver offline
      });
    })
  );
});

// Atualizando o cache quando necessário
self.addEventListener("activate", (event) => {
  event.waitUntil(
    caches.keys().then((cacheNames) => {
      return Promise.all(
        cacheNames
          .filter((name) => name !== CACHE_NAME)
          .map((name) => caches.delete(name))
      );
    })
  );
});
